# 说明

本文件为完成cs336_assignment2的与DDP分布式训练和Sharded Optimizer相关的实现，每一个一组标题对应一个[官方作业指导说明书](./cs336_spring2025_assignment2_systems.pdf)中的一个需要自己实现的部分。每个部分的要求以及相关指导在指导书中有详细描述。如果涉及到相关代码，在每个一组标题下会单独标注在项目中的代码位置。

**举例** 以distributed_communication_single_node为例，对应说明书中P26中的图示部分，代码位置是在tests/DDP_allreduce_demo.py

![image-9](assets/image16.png)

# 3.2 Zero-shot MATH Baseline

## math_baseline P6

(a)测试 Qwen 2.5 Math 1.5B zero-sho在gsm8k test数据集上的性能，从多个角度分析结果

按照官方给出的奖励模型来判断模型的回答和gt是否是同一个答案，但是模型要求严格的format，不然就自成是结果错误，并且对于除了纯数字的输出可以判断为正确，即使答案正确但是包含了其他文字，也会算做不正确。

(b)正确率为1.66%，分析出错的所有情况：
题目一共有1319个，其中format和answer都正确的有22个，format正确但是answer不正确的有252个，format和answer都不正确的有1045个

分析具体的case可以得到以下几个结论：

1. 1.5B模型的指令跟随能力不强，无法正确输出\<think\> \</think\> \<answer\> \</answer\>等格式，在这个部分中，也有一些输出其实是正确的，只是没有遵循要求的格式。
2. 有部分遵循了格式但是结果判断为错误的，其实是正确的，只是说了一句陈述句来表达结果，但是由于结果解析匹配的问题，导致判断为了不正确。
3. 虽然这样的格式要求和正确性判断无法测试出Qwen 2.5 Math 1.5B对于数学问题的真实回答水平，但是可以在后续的sft和rl中看到明显的测评结果提升，从而学习sft和rl的效果特征。
